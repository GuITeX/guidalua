% !TeX program = LuaLaTeX
% filename: code/e0-003.tex

\documentclass{article}
\usepackage{tikz}

\directlua{
function glyph(code)
    local n = node.new("glyph")
    n.font = font.current()
    n.char = code
    return n.width, n
end
function glue(x)
    local g = node.new "glue"
    g.width = x
    return g
end
}

\newbox\sptxt
\newcommand{\spacedtext}[2]{\directlua{
    local s = [==[#2]==]
    local gap = assert(tex.sp([[#1]]))
    local w1 = gap
    local head, last
    for n in string.utfvalues(s) do
        local wn, gn = glyph(n)
        local g = glue(gap - (w1 + wn)/2)
        head, last = node.insert_after(head, last, g)
        head, last = node.insert_after(head, last, gn)
        w1 = wn
    end
    local hbox = node.hpack(head)
    tex.box["sptxt"] = hbox
}\box\sptxt}

\begin{document}
\begin{tikzpicture}
\draw[xstep=20pt,ystep=14pt] (0, 0) grid (220pt, 14pt);
\node[anchor=base west,inner sep=0pt] at (0,3pt) {\spacedtext{20pt}{I Will-Ã¨i12}};
\end{tikzpicture}
\end{document}








