% !TeX program = LuaLaTeX
% filename: code/e0-003.tex

\documentclass{article}

\newcommand{\isodate}[1]{\directlua{
local isodate = [[#1]]
% conversione numerica della data
local y = assert(math.tointeger(isodate:sub(1,4)))
local m = assert(math.tointeger(isodate:sub(6,7)))
local d = assert(math.tointeger(isodate:sub(9)))
% controllo di validitÃ 
assert(y > 1969)
assert(m > 0 and m < 13)
assert(d > 0 and d < 32)
assert(isodate:sub(5,5)=="-")
assert(isodate:sub(8,8)=="-")
% stampa nel formato esteso giorno mese anno
local month = {
   "gennaio", "febbraio", "marzo", "aprile", "maggio", "giugno",
   "luglio", "agosto", "settembre", "ottobre", "novembre", "dicembre"
}
tex.print(d.." "..month[m].." "..y)
}}

\begin{document}
\noindent\isodate{2001-06-28}\\
\isodate{1998-01-01}\\
\isodate{2010-12-31}
\end{document}
